var Persuaxion=function(t){"use strict";const e="__px_uid",n="__px_sid";function o(){return"undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function i(){const{id:t,existed:i}=function(){const t=function(t){const e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):null}(e);if(t)return{id:t,existed:!0};const n=o();return function(t,e){const n=new Date(Date.now()+31536e6).toUTCString();document.cookie=t+"="+encodeURIComponent(e)+"; expires="+n+"; path=/; SameSite=Lax"}(e,n),{id:n,existed:!1}}(),{id:a,isNew:r}=function(){try{const t=sessionStorage.getItem(n);if(t)return{id:t,isNew:!1};const e=o();return sessionStorage.setItem(n,e),{id:e,isNew:!0}}catch(t){return{id:o(),isNew:!0}}}(),s=function(){try{const t=window.__st?.cid??window.__st?.customer_id;return t?String(t):null}catch(t){return null}}(),c=!s&&!i;return{anonymousUserId:t,sessionId:a,customerId:s,isNewUser:c,isRevisit:!c&&r}}function a(){try{if(window.Shopify?.shop)return window.Shopify.shop}catch(t){}return window.location.hostname}const r=[[/^\/products\/[^/]+/,"product"],[/^\/collections\//,"collection"],[/^\/cart/,"cart"],[/^\/pages\//,"page"],[/^\/blogs\//,"blog"],[/^\/$/,"home"]];function s(){try{if(window.meta?.page?.pageType)return window.meta.page.pageType;if(window.ShopifyAnalytics?.meta?.page?.pageType)return window.ShopifyAnalytics.meta.page.pageType}catch(t){}const t=window.location.pathname;for(const[e,n]of r)if(e.test(t))return n;return"other"}function c(){try{const t=window.ShopifyAnalytics?.meta?.product?.id??window.meta?.product?.id??window.__st?.pid;return t?String(t):null}catch(t){return null}}function d(){try{const t=new URLSearchParams(window.location.search).get("variant");if(t)return t;const e=window.ShopifyAnalytics?.meta?.selectedVariantId??window.meta?.selectedVariantId;return e?String(e):null}catch(t){return null}}let u="";function l(t){if(u)try{fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),keepalive:!0}).catch(function(){})}catch(t){}}const p=new Set(["INPUT","SELECT","TEXTAREA","OPTION","SCRIPT","STYLE"]),m=[25,50,75,80];const f=['[role="dialog"]','[aria-modal="true"]',".modal",".modal__overlay",".drawer",".drawer__inner",".popup",".overlay","[data-modal]","[data-drawer]","[data-popup]"];function y(t){try{const e=t.querySelector("h1, h2, h3, h4, [data-title], [data-heading], .modal__title, .modal-title, .drawer__title, .popup__title, .overlay__title");if(e){const t=(e.innerText||e.textContent||"").trim();if(t)return t.slice(0,200)}const n=t.getAttribute("aria-label")||t.getAttribute("aria-labelledby");return n&&!n.match(/^\d+$/)?n.slice(0,200):(t.innerText||t.textContent||"").trim().slice(0,100)||null}catch(t){return null}}function _(t){return t.nodeType===Node.ELEMENT_NODE&&f.some(function(e){try{return t.matches(e)}catch(t){return!1}})}const x=["[data-option-value]","[data-value]","[data-option-index]",".swatch__input",".variant__button",".color-swatch",'[name^="option"]'].join(", ");return t.init=function({shopDomain:t}){const e=i(),n={shopDomain:a(),pageType:s(),productId:c(),variantId:d()},o={anonymousUserId:e.anonymousUserId,sessionId:e.sessionId,customerId:e.customerId,isNewUser:e.isNewUser,isRevisit:e.isRevisit,shopDomain:t||n.shopDomain,pageType:n.pageType,productId:n.productId,variantId:n.variantId};function r(t){return{anonymous_user_id:o.anonymousUserId,session_id:o.sessionId,customer_id:o.customerId,shop_domain:o.shopDomain,page_type:o.pageType,product_id:o.productId,variant_id:o.variantId,is_new_user:o.isNewUser,is_revisit:o.isRevisit,event_type:t.event_type,element_text:t.element_text??null,element_type:t.element_type??null,metadata:t.metadata??{},ts:Date.now()}}function f(t){l(r(t))}u="https://api.persuaxion.app/api/events",function(t,e){document.addEventListener("click",function(t){const n=t.target;if(!n||!n.tagName)return;if(p.has(n.tagName))return;if(n.closest&&n.closest("[data-px-ignore]"))return;const{text:o,el:i}=function(t){let e=t;for(let t=0;t<3;t++){const t=(e.innerText||e.textContent||"").trim();if(t)return{text:t,el:e};if(!e.parentElement)break;e=e.parentElement}return{text:"",el:t}}(n);if(!o)return;const a=o.length>200?o.slice(0,200):o,r=i.getAttribute("role"),s=r?i.tagName.toLowerCase()+"["+r+"]":i.tagName.toLowerCase();e({event_type:"click",element_text:a,element_type:s,metadata:{}})},{passive:!0})}(0,f),function(t,e){const n=new Set,o=Date.now();let i=!1;function a(){i=!1;const t=function(){const t=document.documentElement,e=window.scrollY||t.scrollTop,n=t.scrollHeight-t.clientHeight;return n<=0?0:Math.min(100,Math.round(e/n*100))}(),a=Math.round((Date.now()-o)/1e3);for(const o of m)t>=o&&!n.has(o)&&(n.add(o),e({event_type:"scroll",element_text:null,element_type:null,metadata:{scroll_pct:o,time_on_page:a}}))}window.addEventListener("scroll",function(){i||(i=!0,requestAnimationFrame(a))},{passive:!0})}(0,f),function(t,e){new MutationObserver(function(t){for(const n of t){if("attributes"===n.type&&"aria-expanded"===n.attributeName){const t=n.target;if("true"===t.getAttribute("aria-expanded")&&"false"===n.oldValue){const n=y(t);e({event_type:"accordion_expand",element_text:n,element_type:t.tagName.toLowerCase(),metadata:{}})}continue}if("childList"===n.type)for(const t of n.addedNodes){if(!_(t))continue;try{const e=window.getComputedStyle(t);if("none"===e.display||"hidden"===e.visibility)continue}catch(t){}const n=t.getAttribute("role"),o=y(t);e({event_type:"modal_open",element_text:o,element_type:n||t.tagName.toLowerCase(),metadata:{}})}}}).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["aria-expanded"]})}(0,f),function(t,e){let n=t.variantId;function o(o,i){if(!o)return;if(o===n)return;const a=n;n=o,t.variantId=o,e({event_type:"variant_change",element_text:i||null,element_type:"variant_selector",metadata:{variant_id:o,from_variant:a}})}document.addEventListener("change",function(t){const e=t.target;if(!e||"SELECT"!==e.tagName)return;const n=(e.name||"").toLowerCase(),i=(e.id||"").toLowerCase();if(!n.includes("option")&&!i.includes("option"))return;const a=e.options[e.selectedIndex],r=a?a.text.trim():e.value;o(e.value,r)},{passive:!0}),document.addEventListener("click",function(t){if(!t.target||!t.target.closest)return;const e=t.target.closest(x);if(!e)return;if("SELECT"===e.tagName)return;const n=e.dataset.optionValue||e.dataset.value||e.value||e.getAttribute("value")||(e.innerText||e.textContent||"").trim();o(n,(e.innerText||e.textContent||"").trim()||n)},{passive:!0})}(o,f),function(){let t=!1;function e(e){t||(t=!0,function(t){if(u)try{const e=new Blob([JSON.stringify(t)],{type:"application/json"});if("function"==typeof navigator.sendBeacon&&navigator.sendBeacon(u,e))return;l(t)}catch(t){}}(r({event_type:"exit_intent",element_text:null,element_type:null,metadata:{trigger:e}})))}document.addEventListener("mouseleave",function(t){t.clientY<0&&e("mouseleave")}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e("visibilitychange")})}()},t}({});
